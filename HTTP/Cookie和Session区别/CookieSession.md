# Cookie和Session的区别

## Session
由于HTTP协议是无状态无连接的，所以服务端需要记录用户的状态时，就需要某种机制来识别具体的用户，这个机制就是Session。典型的场景比如购物车，当你点击下单按钮时，由于HTTP协议无状态，所以并不知道是哪个用户操作的，所以服务端要为特定的用户创建了特定的Session，用于标识这个用户，并且跟踪用户，这样才知道购物车里面有几本书，这个Session是保存在服务端的，有一个唯一标识。

在服务端保存Session的方法有很多，内存、数据库、文件都可以。集群的时候也要考虑Session的转移，在大型的网站，一般会有专门的Session服务器集群，用来保存用户会话，这个时候Session信息都是放在内存的，使用一些缓存服务比如Memcached之类的来放Session。

<b>当程序要为客户端的请求创建会话时，服务器首先检查客户端的请求是否包含会话标识符（Session ID），如果包含它，它先前以为此客户端创建了一个会话（Session），服务端根据会话ID检索会话，如果客户端请求不包含会话ID，服务端则会为客户端创建会话并生成与会话关联的会话ID。</b>

保存会话ID的方法可以是Cookie，当客户端浏览器的Cookie被禁止的话，会采用<b>URL重写</b>或<b>表单隐藏字段</b>的技术将会话ID传递会服务器。

## Cookie
关于服务端如何识别特定的客户，这个时候就需要Cookie，每次HTTP请求的时候，客户端都会发送响应的Cookie信息到服务端，实际上大多数的应用都是用Cookie来实现Session跟踪的，第一次创建Session的时候，服务端会在HTTP协议中告诉客户端，需要在浏览器的Cookie里面记录一个Session ID，以后每次请求把这个会话ID发送到服务器，服务器就会知道客户是谁了。

如果客户端的浏览器禁用了Cookie，这种情况下，会使用一种叫做URL重写的技术来进行会话跟踪，即每次HTTP交互，URL后面都会被附加上一个诸如 sid=xxxx 这样的参数，服务端据此来识别用户。

Cookie还可以用在一些方便用户的场景下，设想某次登陆过一个网站，下次登录的时候不想再输入账号了，这个信息可以写道Cookie里面，访问网站的时候，网站页面的脚本可以读取这个信息，就自动帮忙把用户名给填了。

<b>Cookie机制，正统的Cookie分发是通过扩展HTTP协议来实现的，服务器通过在HTTP的响应头中加上一行特殊的指示以提示浏览器按照指示生成响应的Cookie。Cookie的使用是由浏览器按照一定的原则在后台自动发送给服务器的。浏览器检查所有存储的Cookie，如果某个Cookie所声明的作用范围大于等于要请求的资源所在的位置，则把该Cookie附在请求资源的HTTP请求头上发送给服务器。</b>

Cookie的内容主要包括：名字，值，过期时间，路径和域。路径和域一起构成Cookie的作用范围。若不设置过期时间，则表示这个Cookie的生命周期为浏览器会话时间，关闭浏览器窗口，Cookie就会消失。

## 总结
Session是服务端保存的一个数据结构，用来跟踪用户的状态，这个数据可以保存在集群、数据库、文件中。
Cookie是客户端保存用户信息的一种机制，用来记录用户的一些信息也是实现Session的一种方式。

